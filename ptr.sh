Спасибо за уточнение. Давайте скорректируем регулярное выражение для извлечения имен зон и файлов из вашего конфигурационного файла. В данном случае проблема может заключаться в том, что мы неправильно обрабатываем кавычки и пробелы в регулярных выражениях.

Вот исправленный вариант скрипта, который будет правильно извлекать зоны из вашего файла /etc/named.conf:

```
#!/bin/bash

# Проверяем, что файл конфигурации существует
if [ ! -f /etc/named.conf ]; then
    echo "Файл /etc/named.conf не найден."
    exit 1
fi

# Читаем зоны из файла конфигурации
declare -A zones
while IFS= read -r line; do
    if [[ $line =~ zone\ \"([0-9\.]+)\.in-addr\.arpa\" ]]; then
        zone_name="${BASH_REMATCH[1]}"
        if [[ $line =~ file\ \"([^\"]+)\" ]]; then
            file_name="${BASH_REMATCH[1]}"
            # Проверяем, что имя файла заканчивается на .db
            if [[ $file_name == *.db ]]; then
                zones["$zone_name"]="$file_name"
            else
                echo "Имя файла зоны \"$file_name\" не соответствует формату *.db"
            fi
        fi
    fi
done < /etc/named.conf

# Проверяем, найдены ли зоны
if [ ${#zones[@]} -eq 0 ]; then
    echo "Зоны не найдены в /etc/named.conf."
    exit 1
fi

# Запрашиваем у пользователя имя файла с A-записями
read -p "Введите имя файла с A-записями (например, abcd.db): " a_record_file

# Проверяем, существует ли файл с A-записями
if [ ! -f "/var/named/$a_record_file" ]; then
    echo "Файл /var/named/$a_record_file не найден."
    exit 1
fi

# Копируем первые 8 строк из файла с A-записями в новый файл PTR-записей
for zone in "${!zones[@]}"; do
    ptr_file="/var/named/${zones[$zone]}"

    # Копируем первые 8 строк
    head -n 8 "/var/named/$a_record_file" > "$ptr_file"

    # Генерация PTR-записей
    while IFS= read -r line; do
        if [[ $line =~ ([0-9\.]+)\s+IN\s+A ]]; then
            ip="${BASH_REMATCH[1]}"
            IFS='.' read -r i1 i2 i3 i4 <<< "$ip"
            domain=$(echo "$line" | awk '{print $1}')
            echo "${i4}.${i3}.${i2}.${i1}.in-addr.arpa. IN PTR $domain." >> "$ptr_file"
        fi
    done < "/var/named/$a_record_file"

    echo "Файл $ptr_file создан."
done

echo "Все PTR-записи созданы."
```

### Объяснение изменений:

- **Коррекция регулярных выражений**: Я исправил регулярное выражение для извлечения имени файла из конфигурации. Теперь оно правильно работает с кавычками.

- **Проверка на окончание .db**: Я убедился, что проверка на окончание файла по-прежнему сохранена.

- **Форматирование кода**: Код остался высоким, во избежание уменьшения его читаемости.

### Как использовать:

Сохраните этот скрипт в файл, например, generate_ptr.sh, дайте ему права на выполнение с помощью chmod +x generate_ptr.sh, и запустите его с помощью ./generate_ptr.sh.

Теперь скрипт должен корректно обрабатывать ваш файл /etc/named.conf. Если возникнут какие-либо проблемы или будут нужны дальнейшие изменения, дайте знать!
